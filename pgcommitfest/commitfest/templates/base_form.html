{%extends "base.html"%}
{%load selectable_tags%}
{%load commitfest%}

{%block contents%}
<style>
.form-horizontal div.form-group {
   margin-bottom: 10px;
}
div.form-group div.controls ul {
   list-style-type: none;
   margin: 0px;
   padding: 0px;
}
div.form-group div.controls ul li {
   display: inline;
}
div.form-group div.controls ul li label {
   display: inline;
   font-weight: normal;
   vertical-align:middle;
}
div.form-group div.controls ul li label input {
   display: inline;
   vertical-align:middle;
}
div.form-group div.controls input[type='checkbox'] {
   width: 10px;
}

div.controls ul.selectable-deck li.selectable-deck-item {
   display: block;
}

div.controls ul.selectable-deck li.selectable-deck-item a.selectable-deck-remove {
   float: none;
   margin-left: 10px;
}

div.form-group div.controls input.threadpick-input {
   width: 80%;
   display: inline;
}
</style>
<form class="form-horizontal {{extraformclass}}" method="POST" action=".">{%csrf_token%}
{%if form.errors%}
 <div class="alert">Please correct the errors below, and re-submit the form.</div>
{%endif%}
{%if form.non_field_errors%}
 <div class="alert alert-danger">{{form.non_field_errors}}</div>
{%endif%}
{%if note%}
<div class="alert alert-info">{{note|safe}}</div>
{%endif%}
 {%for field in form%}
 <div class="form-group">
   {{field|label_class:"control-label col-lg-1"}}
   <div class="col-lg-11 controls">
  {%if field.errors %}
   {%for e in field.errors%}
 <div class="alert alert-danger">{{e}}</div>
   {%endfor%}
  {%endif%}
{{field|field_class:"form-control"}}
{%if field.help_text%}<br/>{{field.help_text|safe}}{%endif%}</div>
 </div>
{%endfor%}
 <div class="form-group">
  <div class="col-lg-12">
   <div class="control"><input type="submit" class="btn btn-default" value="{{savebutton|default:"Save"}}"></div>
  </div>
 </div>
</form>

{%if threadbrowse %}
{%include "thread_attach.inc" %}
{%endif%}
{%endblock%}

{%if threadbrowse %}
{%block morescript%}
<script>
/* Set up djselectable to use bootstrap buttons */
$.ui.djselectable.prototype._comboButtonTemplate = function (input) {
    var icon = $("<i>").addClass("glyphicon glyphicon-chevron-down");
    // Remove current classes on the text input
    $(input).attr("class", "");
    // Wrap with input-append
    $(input).wrap('<div class="input-append" />');
    // Return button link with the chosen icon
    return $("<a>").append(icon).addClass("btn btn-default btn-xs");
};
$.ui.djselectable.prototype._removeButtonTemplate = function (item) {
    var icon = $("<i>").addClass("glyphicon glyphicon-remove-sign");
    // Return button link with the chosen icon
    return $("<a>").append(icon).addClass("btn btn-default btn-xs selectable-deck-remove");
};

/* Build our button callbacks */
$(document).ready(function() {
   $('button.attachThreadButton').each(function (i,o) {
      var b = $(o);
      b.click(function() {
         browseThreads(function(msgid) {
            b.prev().val(msgid);
            return true;
         });
         return false;
      });
   });
});
</script>
{%endblock%}
{%endif%}
